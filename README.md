# Q-Learning Trading Agent

## Introduction

Design a learning trading agent that uses a Q-learning-based strategy and technical indicators. This is Part 4 in a four-part series of Machine Learning Algorithms:

* [**Part 1**](https://github.com/ntrang086/ml_trading_defeat_learners): Implement the Linear Regression Learner and Decision Tree Learner and generate data that works better for one learner than the other.
* [**Part 2**](https://github.com/ntrang086/ml_trading_assess_learners): Implement Random Tree Learner, Bag learner and Insane Learner. Evaluate all the learners implemented in Parts 1 and 2.
* [**Part 3**](https://github.com/ntrang086/q_learning_robot): Implement the Q-Learning and Dyna-Q solutions to the reinforcement learning problem.
* [**Part 4**](https://github.com/ntrang086/q_learning_trading) (this repository): Implement a learning trading agent using Q-learning.

## Code

* `StrategyLearner.py` - Main code for a StrategyLearner that uses Q-learning and technical indicators to trade a stock.
* `q_learning_trading_example.ipynb` - Example of how a StrategyLearner works. This code is also available in the `__main__` function of `StrategyLearner.py`.
* `QLearner.py` - Code for Q-learning, a reinforcement learning technique. It was first developed and tested in a navigation problem in [Part 3](https://github.com/ntrang086/q_learning_robot).
* `indicators.py` - Technical indicators to be used as features by a StrategyLearner. They were first developed and used in a [rule-based trading strategy](https://github.com/ntrang086/rule_based_trading)
* `marketsim.py` - A market simulator that computes and visualizes statistics from trades generated by a StrategyLearner. It was first developed in [Computational Investing](https://github.com/ntrang086/computational_investing), but has been updated here to read in a dataframe of trades instead of a csv file. There is also an update on how it visualizes a stock's performance.
* `analysis.py` - Helper code for `marketsim.py`. It was first developed in [Analyze Financial Data](https://github.com/ntrang086/analyze_financial_data)
* `util.py` - Util functions for `StrategyLearner.py`, e.g. loading data, creating dataframes, etc.
* `grade_strategy_learner.py` - Main test code for StrategyLearner
* `grading.py` - Helper test code for `grade_strategy_learner.py`

## Setup

You need Python 2.7.x or 3.x (recommended), and the following packages: pandas, numpy, and matplotlib.

## Data

Data files can be downloaded from [this link](http://quantsoftware.gatech.edu/images/a/af/ML4T_2017Fall.zip) or from [Yahoo Finance](https://finance.yahoo.com/)

Place the data into a directory named 'data' and it should be one level above this repository.

## Run

To run any script file, use:

```bash
python <script.py>
```

To run any IPython Notebook, use:

```bash
jupyter notebook <notebook_name.ipynb>
```

Source: [Part 3](http://quantsoftware.gatech.edu/Machine_Learning_Algorithms_for_Trading) of [Machine Learning for Trading](http://quantsoftware.gatech.edu/Machine_Learning_for_Trading_Course) by Georgia Tech
